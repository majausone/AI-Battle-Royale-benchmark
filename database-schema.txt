Tabla: ai_services
-------------------------
service_id      INTEGER     PRIMARY KEY
name            TEXT        NOT NULL
type            TEXT        NOT NULL
endpoint        TEXT        NOT NULL
api_key         TEXT        NOT NULL
model           TEXT        NOT NULL
is_active       BOOLEAN     DEFAULT 1
is_thinking     BOOLEAN     DEFAULT 0
is_reasoning    BOOLEAN     DEFAULT 0
is_mirror       BOOLEAN     DEFAULT 0
deleted         INTEGER     DEFAULT 0

Tabla: teams
-------------------------
team_id         INTEGER     PRIMARY KEY
name            TEXT        NOT NULL
color           TEXT        NOT NULL
is_available    INTEGER     DEFAULT 1
deleted         INTEGER     DEFAULT 0

Tabla: team_ais
-------------------------
ai_id           INTEGER     PRIMARY KEY
team_id         INTEGER     NOT NULL
service_id      INTEGER     NOT NULL
FOREIGN KEY (team_id) REFERENCES teams(team_id)
FOREIGN KEY (service_id) REFERENCES ai_services(service_id)

Tabla: ai_available_units
-------------------------
id              INTEGER     PRIMARY KEY
team_ai_id      INTEGER     NOT NULL
unit_id         TEXT        NOT NULL
FOREIGN KEY (team_ai_id) REFERENCES team_ais(ai_id)
UNIQUE(team_ai_id, unit_id)

Tabla: ai_purchased_units
-------------------------
id              INTEGER     PRIMARY KEY
team_ai_id      INTEGER     NOT NULL
unit_id         TEXT        NOT NULL
quantity        INTEGER     NOT NULL
FOREIGN KEY (team_ai_id) REFERENCES team_ais(ai_id)

Tabla: matches
-------------------------
match_id        INTEGER     PRIMARY KEY
start_time      DATETIME    NOT NULL
end_time        DATETIME
status          TEXT        NOT NULL
created_at      DATETIME    DEFAULT CURRENT_TIMESTAMP

Tabla: match_participants
-------------------------
participant_id  INTEGER     PRIMARY KEY
match_id        INTEGER     NOT NULL
ai_id           INTEGER     NOT NULL
is_winner       INTEGER     DEFAULT 0
created_at      DATETIME    DEFAULT CURRENT_TIMESTAMP
FOREIGN KEY (match_id) REFERENCES matches(match_id)
FOREIGN KEY (ai_id) REFERENCES team_ais(ai_id)
UNIQUE(match_id, ai_id)

Tabla: match_state
-------------------------
match_id        INTEGER     PRIMARY KEY
current_round   INTEGER     NOT NULL DEFAULT 1
status          TEXT        NOT NULL DEFAULT 'in_progress'
FOREIGN KEY (match_id) REFERENCES matches(match_id)

Tabla: responses
-------------------------
response_id     INTEGER     PRIMARY KEY
ai_id           INTEGER     NOT NULL
match_id        INTEGER     NOT NULL
response        TEXT        NOT NULL
has_errors      INTEGER     DEFAULT 0
has_warnings    INTEGER     DEFAULT 0
response_time   REAL
created_at      DATETIME    DEFAULT CURRENT_TIMESTAMP
FOREIGN KEY (ai_id) REFERENCES team_ais(ai_id)
FOREIGN KEY (match_id) REFERENCES matches(match_id)

Tabla: files
-------------------------
file_id         INTEGER     PRIMARY KEY
ai_id           INTEGER     NOT NULL
match_id        INTEGER     NOT NULL
filename        TEXT        NOT NULL
created_at      DATETIME    DEFAULT CURRENT_TIMESTAMP
FOREIGN KEY (match_id) REFERENCES matches(match_id)
FOREIGN KEY (ai_id) REFERENCES team_ais(ai_id)

Tabla: ai_evaluations
-------------------------
evaluation_id     INTEGER     PRIMARY KEY
match_id          INTEGER     NOT NULL
evaluator_ai_id   INTEGER     NOT NULL
evaluated_ai_id   INTEGER     NOT NULL
knows_evaluated   INTEGER     DEFAULT 0
creativity_score  REAL
code_quality_score REAL
comments          TEXT
created_at        DATETIME    DEFAULT CURRENT_TIMESTAMP
FOREIGN KEY (match_id) REFERENCES matches(match_id)
FOREIGN KEY (evaluator_ai_id) REFERENCES team_ais(ai_id)
FOREIGN KEY (evaluated_ai_id) REFERENCES team_ais(ai_id)

Tabla: game_settings
-------------------------
id              INTEGER     PRIMARY KEY
initial_gold    INTEGER     NOT NULL
num_rounds      INTEGER     NOT NULL
error_penalty   INTEGER     NOT NULL
max_errors      INTEGER     NOT NULL

Tabla: display_settings
-------------------------
id                      INTEGER     PRIMARY KEY
show_fps_counter        BOOLEAN     DEFAULT 0
show_units_counter      BOOLEAN     DEFAULT 0
show_game_speed_indicator BOOLEAN   DEFAULT 0
volume                  INTEGER     DEFAULT 50
game_speed              REAL        DEFAULT 1.0

Tabla: round_history
-------------------------
id              INTEGER     PRIMARY KEY
match_id        INTEGER     NOT NULL
round_number    INTEGER     NOT NULL
winner_team_id  INTEGER     NOT NULL
timestamp       DATETIME    DEFAULT CURRENT_TIMESTAMP
FOREIGN KEY (match_id) REFERENCES matches(match_id)
FOREIGN KEY (winner_team_id) REFERENCES teams(team_id)

Tabla: round_team_states
-------------------------
id              INTEGER     PRIMARY KEY
round_history_id INTEGER    NOT NULL
team_id         INTEGER     NOT NULL
was_alive       BOOLEAN     NOT NULL
FOREIGN KEY (round_history_id) REFERENCES round_history(id)
FOREIGN KEY (team_id) REFERENCES teams(team_id)

Tabla: round_wins
-------------------------
id              INTEGER     PRIMARY KEY
match_id        INTEGER     NOT NULL
team_id         INTEGER     NOT NULL
wins_count      INTEGER     NOT NULL DEFAULT 0
FOREIGN KEY (match_id) REFERENCES matches(match_id)
FOREIGN KEY (team_id) REFERENCES teams(team_id)
UNIQUE(match_id, team_id)

√çndices:
-------------------------
idx_participants_match  ON match_participants(match_id)
idx_participants_ai     ON match_participants(ai_id)
idx_responses_match     ON responses(match_id)
idx_responses_ai        ON responses(ai_id)
idx_evaluations_match   ON ai_evaluations(match_id)
idx_round_history_match ON round_history(match_id)
idx_round_wins_match    ON round_wins(match_id)
idx_round_wins_team     ON round_wins(team_id)
idx_files_match         ON files(match_id)
idx_files_ai            ON files(ai_id)